var len,timer,root=window.player,dataList=[],audio=root.audioManager,controlIndex=null,duration=0;function getData(o){$.ajax({type:"GET",url:o,success:function(o){len=o.length,controlIndex=new root.controlIndex(len),dataList=o,root.render(o[0]),audio.getAudio(o[0].audio),bindEvent(),bindTouch(),$("body").trigger("play:change",0)},error:function(){}})}function bindEvent(){$("body").on("play:change",function(o,t){audio.getAudio(dataList[t].audio),root.render(dataList[t]),root.pro.renderAllTime(dataList[t].duration),"play"==audio.status?(audio.play(),root.pro.start(0),rotated(0)):root.pro.update(0),$(".img-box").attr("data-deg",0),$(".img-box").css({transform:"rotateZ(0deg)",transition:"none"})}),$(".prev").on("click",function(o){var t=controlIndex.prev();$("body").trigger("play:change",t),root.pro.start(0),"pause"==audio.status&&(audio.pause(),root.pro.stop())}),$(".next").on("click",function(o){var t=controlIndex.next();$("body").trigger("play:change",t),root.pro.start(0),"pause"==audio.status&&(audio.pause(),root.pro.stop())}),$(".play").on("click",function(o){"pause"==audio.status?(audio.play(),root.pro.start(),rotated($(".img-box").attr("data-deg")||0)):(audio.pause(),root.pro.stop(),clearInterval(timer));$(".play").toggleClass("playing")})}function rotated(o){clearInterval(timer),o=+o,timer=setInterval(function(){o+=2,$(".img-box").attr("data-deg",o),$(".img-box").css({transform:"rotateZ("+o+"deg)",transition:"transform 0.2s linear"})},200)}function bindTouch(){var o=$(".pro-wrap").offset(),r=o.left,n=o.width;$(".spot").on("touchstart",function(o){root.pro.stop()}).on("touchmove",function(o){var t=(o.changedTouches[0].clientX-r)/n;0<t&&t<1&&root.pro.update(t)}).on("touchend",function(o){var t=(o.changedTouches[0].clientX-r)/n;if(0<t&&t<1){var a=t*dataList[controlIndex.index].duration;$(".play").addClass("playing"),audio.playTo(a),audio.play(),audio.status="play",root.pro.start(t),$(".play").addClass("playing")}})}getData("/dist/mock/data.json");